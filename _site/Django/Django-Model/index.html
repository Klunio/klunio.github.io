<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.16.5 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="zh" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Model in Django - Clooney’s site</title>
<meta name="description" content="  refer">


  <meta name="author" content="Clooney">


<meta property="og:type" content="article">
<meta property="og:locale" content="zh_CN">
<meta property="og:site_name" content="Clooney's site">
<meta property="og:title" content="Model in Django">
<meta property="og:url" content="http://localhost:4000/Django/Django-Model/">


  <meta property="og:description" content="  refer">







  <meta property="article:published_time" content="2019-08-12T02:55:40-04:00">






<link rel="canonical" href="http://localhost:4000/Django/Django-Model/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Clooney",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Clooney's site Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt=""></a>
        
        <a class="site-title" href="/">
          Clooney's site
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li><li class="masthead__menu-item">
              <a href="https://mmistakes.github.io/minimal-mistakes/about/" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/Django/" >Django</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">切换菜单</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">首页</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/django" itemprop="item"><span itemprop="name">Django</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Model in Django</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/bio-photo.jpeg" alt="Clooney" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Clooney</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I’m doing my homework here!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">关注</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Guangzhou, China</span>
        </li>
      

      

      

      
        <li>
          <a href="mailto:gkluni317@gmail.com">
            <meta itemprop="email" content="gkluni317@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> 电子邮箱
          </a>
        </li>
      

      

      

      

      

      

      
        <li>
          <a href="https://instagram.com/yyunquan" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram
          </a>
        </li>
      

      

      

      
        <li>
          <a href="https://github.com/Klunio" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.weibo.com/xxx" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-weibo" aria-hidden="true"></i> Weibo
          </a>
        </li>
      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Model in Django">
    <meta itemprop="description" content="  refer">
    <meta itemprop="datePublished" content="August 12, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Model in Django
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-align-left"></i> 文章结构</h4></header>
              <ul class="toc__menu">
  <li><a href="#一抽象基类">一、抽象基类</a>
    <ul>
      <li><a href="#抽象基类的meta数据">抽象基类的Meta数据：</a></li>
      <li><a href="#警惕related_name和related_query_name参数">警惕related_name和related_query_name参数</a></li>
    </ul>
  </li>
  <li><a href="#二多表继承">二、多表继承</a></li>
  <li><a href="#三代理模型">三、代理模型</a></li>
  <li><a href="#四文件结构组织">四、文件结构组织</a></li>
</ul>
            </nav>
          </aside>
        
        <blockquote>
  <p><a href="http://www.liujiangblog.com/course/django/100">refer</a></p>
</blockquote>

<p>Django中所有的模型都必须继承<code class="highlighter-rouge">django.db.models.Model</code>模型，不管是直接继承也好，还是间接继承也罢。</p>

<p>你唯一需要决定的是，父模型是否是一个独立自主的，同样在数据库中创建数据表的模型，还是一个只用来保存子模型共有内容，并不实际创建数据表的抽象模型。</p>

<p>Django有三种继承的方式：</p>

<ul>
  <li>抽象基类：被用来继承的模型被称为<code class="highlighter-rouge">Abstract base classes</code>，将子类共同的数据抽离出来，供子类继承重用，它不会创建实际的数据表；</li>
  <li>多表继承：<code class="highlighter-rouge">Multi-table inheritance</code>，每一个模型都有自己的数据库表；</li>
  <li>代理模型：如果你只想修改模型的Python层面的行为，并不想改动模型的字段，可以使用代理模型。</li>
</ul>

<h3 id="一抽象基类">一、抽象基类</h3>

<p>只需要在模型的Meta类里添加<code class="highlighter-rouge">abstract=True</code>元数据项，就可以将一个模型转换为抽象基类。<strong>Django不会为这种类创建实际的数据库表</strong>，它们也没有管理器，不能被实例化也无法直接保存，<strong>它们就是用来被继承的</strong>。抽象基类完全就是用来保存子模型们共有的内容部分，达到重用的目的。当它们被继承时，它们的字段会全部复制到子模型中。看下面的例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">CommonInfo</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">PositiveIntegerField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">CommonInfo</span><span class="p">):</span>
    <span class="n">home_group</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<p>Student模型将拥有name，age，home_group三个字段，并且CommonInfo模型不能当做一个正常的模型使用。</p>

<h4 id="抽象基类的meta数据">抽象基类的Meta数据：</h4>

<p>如果子类没有声明自己的Meta类，那么它将继承抽象基类的Meta类。下面的例子则扩展了基类的Meta：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">CommonInfo</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="c"># ...</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">ordering</span> <span class="o">=</span> <span class="p">[</span><span class="s">'name'</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">CommonInfo</span><span class="p">):</span>
    <span class="c"># ...</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">CommonInfo</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">db_table</span> <span class="o">=</span> <span class="s">'student_info'</span>
</code></pre></div></div>

<p>这里有几点要特别说明：</p>

<ul>
  <li>抽象基类中有的元数据，子模型没有的话，直接继承；</li>
  <li><strong>抽象基类中有的元数据，子模型也有的话，直接覆盖；</strong></li>
  <li>子模型可以额外添加元数据；</li>
  <li>抽象基类中的<code class="highlighter-rouge">abstract=True</code>这个元数据不会被继承。也就是说如果想让一个抽象基类的子模型，同样成为一个抽象基类，那你必须显式的在该子模型的Meta中同样声明一个<code class="highlighter-rouge">abstract = True</code>；</li>
  <li>有一些元数据对抽象基类无效，比如<code class="highlighter-rouge">db_table</code>，首先是抽象基类本身不会创建数据表，其次它的所有子类也不会按照这个元数据来设置表名。</li>
</ul>

<h4 id="警惕related_name和related_query_name参数">警惕related_name和related_query_name参数</h4>

<p>如果在你的抽象基类中存在ForeignKey或者ManyToManyField字段，并且使用了<code class="highlighter-rouge">related_name</code>或者<code class="highlighter-rouge">related_query_name</code>参数，那么一定要小心了。因为按照默认规则，每一个子类都将拥有同样的字段，这显然会导致错误。为了解决这个问题，当你在抽象基类中使用<code class="highlighter-rouge">related_name</code>或者<code class="highlighter-rouge">related_query_name</code>参数时，<strong>它们两者的值中应该包含<code class="highlighter-rouge">%(app_label)s</code>和<code class="highlighter-rouge">%(class)s</code>部分：</strong></p>

<ul>
  <li><code class="highlighter-rouge">%(class)s</code>用字段所属子类的小写名替换</li>
  <li><code class="highlighter-rouge">%(app_label)s</code>用子类所属app的小写名替换</li>
</ul>

<p>例如，对于<code class="highlighter-rouge">common/models.py</code>模块：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Base</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">m2m</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ManyToManyField</span><span class="p">(</span>
    <span class="n">OtherModel</span><span class="p">,</span>
    <span class="n">related_name</span><span class="o">=</span><span class="s">"</span><span class="si">%(app_label)</span><span class="s">s_</span><span class="si">%(class)</span><span class="s">s_related"</span><span class="p">,</span>
    <span class="n">related_query_name</span><span class="o">=</span><span class="s">"</span><span class="si">%(app_label)</span><span class="s">s_</span><span class="si">%(class)</span><span class="s">ss"</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">class</span> <span class="nc">ChildA</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">ChildB</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div>

<p>对于另外一个应用中的<code class="highlighter-rouge">rare/models.py</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">common.models</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="k">class</span> <span class="nc">ChildB</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></div>

<p>对于上面的继承关系：</p>

<ul>
  <li><code class="highlighter-rouge">common.ChildA.m2m</code>字段的<code class="highlighter-rouge">reverse name</code>（反向关系名）应该是<code class="highlighter-rouge">common_childa_related</code>；<code class="highlighter-rouge">reverse query name</code>(反向查询名)应该是<code class="highlighter-rouge">common_childas</code>。</li>
  <li><code class="highlighter-rouge">common.ChildB.m2m</code>字段的反向关系名应该是<code class="highlighter-rouge">common_childb_related</code>；反向查询名应该是<code class="highlighter-rouge">common_childbs</code>。</li>
  <li><code class="highlighter-rouge">rare.ChildB.m2m</code>字段的反向关系名应该是<code class="highlighter-rouge">rare_childb_related</code>；反向查询名应该是<code class="highlighter-rouge">rare_childbs</code>。</li>
</ul>

<p>当然，如果你不设置<code class="highlighter-rouge">related_name</code>或者<code class="highlighter-rouge">related_query_name</code>参数，这些问题就不存在了。</p>

<h3 id="二多表继承">二、多表继承</h3>

<p>这种继承方式下，<strong>父类和子类都是独立自主、功能完整、可正常使用的模型</strong>，都有自己的数据库表，内部隐含了一个一对一的关系。例如：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Place</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">address</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Restaurant</span><span class="p">(</span><span class="n">Place</span><span class="p">):</span>
    <span class="n">serves_hot_dogs</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">serves_pizza</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Restaurant将包含Place的所有字段</strong>，并且各有各的数据库表和字段，比如：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">Place</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Bob's Cafe"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Restaurant</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"Bob's Cafe"</span><span class="p">)</span>
</code></pre></div></div>

<p>如果一个Place对象同时也是一个Restaurant对象，你可以使用小写的子类名，在父类中访问它，例如：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">Place</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c"># 如果p也是一个Restaurant对象，那么下面的调用可以获得该Restaurant对象。</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">restaurant</span>
<span class="o">&lt;</span><span class="n">Restaurant</span><span class="p">:</span> <span class="o">...&gt;</span>
</code></pre></div></div>

<p>其机制内部隐含的OneToOne字段，形同下面所示：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">place_ptr</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">OneToOneField</span><span class="p">(</span>
    <span class="n">Place</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
    <span class="n">parent_link</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<p>可以通过创建一个OneToOneField字段并设置 <code class="highlighter-rouge">parent_link=True</code>，自定义这个一对一字段。</p>

<p>#####个人理解：</p>

<p><strong>假设B继承于A：</strong></p>

<ul>
  <li>A和B的表是独立的</li>
  <li>因为B继承于A，因此在创建B的时候也会同时创建A</li>
  <li>A和B之间是一一对应的（或者A独立）</li>
  <li>由B生成的A是可以用过A.b找到这个原始的B，但是反过来B是找不到对应的A的。</li>
</ul>

<h3 id="三代理模型">三、代理模型</h3>

<p>使用多表继承时，父类的每个子类都会创建一张新数据表，通常情况下，这是我们想要的操作，因为子类需要一个空间来存储不包含在父类中的数据。<strong>但有时，你可能只想更改模型在Python层面的行为，比如更改默认的manager管理器，或者添加一个新方法。</strong></p>

<p>代理模型就是为此而生的。你可以创建、删除、更新代理模型的实例，并且所有的数据都可以像使用原始模型（非代理类模型）一样被保存。<strong>不同之处在于你可以在代理模型中改变默认的排序方式和默认的manager管理器等等</strong>，而不会对原始模型产生影响。</p>

<p><strong>声明一个代理模型只需要将Meta中proxy的值设为True。</strong></p>

<p><strong>一些约束：</strong></p>

<ul>
  <li>代理模型必须继承自一个非抽象的基类，并且不能同时继承多个非抽象基类；</li>
  <li>代理模型可以同时继承任意多个抽象基类，前提是这些抽象基类没有定义任何模型字段。</li>
  <li>代理模型可以同时继承多个别的代理模型，前提是这些代理模型继承同一个非抽象基类。（早期Django版本不支持这一条）</li>
</ul>

<p><strong>代理模型的管理器</strong></p>

<p>如不指定，则继承父类的管理器。如果你自己定义了管理器，那它就会成为默认管理器，但是父类的管理器依然有效。如下例子：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">NewManager</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Manager</span><span class="p">):</span>
    <span class="c"># ...</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">MyPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="n">NewManager</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre></div></div>

<p>如果你想要向代理中添加新的管理器，而不是替换现有的默认管理器，你可以创建一个含有新的管理器的基类，并在继承时把他放在主基类的后面：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create an abstract class for the new manager.</span>
<span class="k">class</span> <span class="nc">ExtraManagers</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">secondary</span> <span class="o">=</span> <span class="n">NewManager</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">class</span> <span class="nc">MyPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="n">ExtraManagers</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="bp">True</span>
</code></pre></div></div>

<h3 id="四文件结构组织">四、文件结构组织</h3>

<p>在我们使用<code class="highlighter-rouge">python manage.py startapp xxx</code>命令创建新的应用时，Django会自动帮我们建立一个应用的基本文件组织结构，其中就包括一个<code class="highlighter-rouge">models.py</code>文件。通常，我们把当前应用的模型都编写在这个文件里，但是如果你的模型很多，那么将单独的<code class="highlighter-rouge">models.py</code>文件分割成一些独立的文件是个更好的做法。</p>

<p>首先，我们需要在应用中新建一个叫做<code class="highlighter-rouge">models</code>的包，再在包下创建一个<code class="highlighter-rouge">__init__.py</code>文件，这样才能确立包的身份。然后将<code class="highlighter-rouge">models.py</code>文件中的模型分割到一些<code class="highlighter-rouge">.py</code>文件中，比如<code class="highlighter-rouge">organic.py</code>和<code class="highlighter-rouge">synthetic.py</code>，然后删除<code class="highlighter-rouge">models.py</code>文件。最后在<code class="highlighter-rouge">__init__.py</code>文件中导入所有的模型。如下例所示：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#  myapp/models/__init__.py</span>

<span class="kn">from</span> <span class="nn">.organic</span> <span class="kn">import</span> <span class="n">Person</span>
<span class="kn">from</span> <span class="nn">.synthetic</span> <span class="kn">import</span> <span class="n">Robot</span>
</code></pre></div></div>

<p>要显式明确地导入每一个模型，而不要使用<code class="highlighter-rouge">from .models import *</code>的方式，这样不会混淆命名空间，让代码更可读，更容易被分析工具使用。</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 分类: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/django" class="page__taxonomy-item" rel="tag">Django</a><span class="sep">, </span>
    
      
      
      <a href="/categories/note" class="page__taxonomy-item" rel="tag">note</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 更新时间:</strong> <time datetime="2019-08-12T02:55:40-04:00">August 12, 2019</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/Django/Django-Note/" class="pagination--pager" title="DJANGO LEARNING NOTE
">向前</a>
    
    
      <a href="/Django/Index/" class="pagination--pager" title="Index
">向后</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="输入您要搜索的关键词..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>关注:</strong></li>
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Clooney. 技术来自于 <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
